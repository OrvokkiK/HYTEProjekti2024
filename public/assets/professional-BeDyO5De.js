import"./style-D24wJ6YD.js";import{f as u}from"./fetch-dnjvk_SN.js";import{s as m}from"./toast-B-6j1RQv.js";let r;document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".menu-toggle"),t=document.querySelector(".menu");e.addEventListener("click",function(){t.classList.toggle("show")}),document.querySelector(".back").addEventListener("click",function(){document.getElementById("detailsModal").style.display="none",document.getElementById("dataSelectionModal").style.display="block"}),document.querySelector(".logout a").addEventListener("click",function(c){c.preventDefault(),console.log("Logout event triggered"),localStorage.removeItem("user_id"),localStorage.removeItem("token"),m("Kirjaudutaan ulos."),setTimeout(()=>{console.log("Redirecting to index.html"),window.location.href="index.html"},2e3)}),p(),f(),g(),v()});async function p(){const e="https://hyte24.northeurope.cloudapp.azure.com/api/student/",o={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};u(e,o).then(n=>{console.log(n),k(n)})}function k(e){const t=document.querySelector("#userTable tbody");t.innerHTML="",e.forEach(o=>{const n=document.createElement("tr");n.innerHTML=`<td>${o.user_id}</td><td>${o.username}</td><td>${o.title}</td>`,n.onclick=()=>y(o.user_id),t.appendChild(n)})}function y(e){r=e,document.getElementById("dataSelectionModal").style.display="block"}function f(){document.querySelector("#userTable tbody").addEventListener("click",t=>{let o=t.target;for(;o.tagName!=="TD";)o=o.parentNode;const n=o.parentNode.firstChild.textContent;y(n)})}function g(){document.querySelectorAll(".data-select").forEach(e=>{e.addEventListener("click",function(){_(e.dataset.type)})})}function v(){document.querySelectorAll(".modal").forEach(e=>{const t=e.querySelector(".close");t.onclick=function(){e.style.display="none"}}),window.onclick=function(e){document.querySelectorAll(".modal").forEach(t=>{e.target===t&&(t.style.display="none")})}}async function _(e){const t={hrv:`https://hyte24.northeurope.cloudapp.azure.com/api/hrv/${r}`,kokonaisanalyysit:`https://hyte24.northeurope.cloudapp.azure.com/api/analysis/user/${r}`,elämäntapakyselyt:`https://hyte24.northeurope.cloudapp.azure.com/api/lifestyle/${r}`,oirearviokyselyt:`https://hyte24.northeurope.cloudapp.azure.com/api/symptoms/${r}`};u(t[e],{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(o=>{console.log(o),S(o,e),document.getElementById("dataSelectionModal").style.display="none",document.getElementById("detailsModal").style.display="block"}).catch(o=>{console.error("Error fetching data:",o),m("Ei dataa saatavilla.")})}function E(e){const t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString("fi-FI",t)}function S(e,t){const o=document.getElementById("detailsContent");o.innerHTML=`<h3>${t.toUpperCase()} :</h3>`;let n={hrv:["Päivämäärä","Bpm Keskiarvo","Stressi-indeksi","Valmiustila (%)","SDNN (ms)","RMDDS (ms)"],kokonaisanalyysit:["Päivämäärä","Analyysi","Pisteet"],oirearviokyselyt:["Päivämäärä","Oireet","Stressitaso"],elämäntapakyselyt:["Päivämäärä","Unen määrä","Unen laatu","Tuntee olonsa terveeksi","Liikunta","Alkoholiannokset","Nikotiini(mg)","Kofeiini"]},c={hrv:["entry_date","av_hrv","stress_index","readiness","sdnn_ms","mean_rr_ms"],kokonaisanalyysit:["created_at","analysis_result","analysis_enumerated"],oirearviokyselyt:["entry_date","stress_level"],elämäntapakyselyt:["entry_date","hours_slept","quality_sleep","feel_healthy","physical_activity","alcohol_intake","nicotine_intake","caffeine_intake"]},a=`<table class='data-table'>
        <thead>
            <tr>`;n[t].forEach(l=>{a+=`<th>${l}</th>`}),a+=`</tr>
        </thead>
        <tbody>`,e.forEach(l=>{a+="<tr>",c[t].forEach(s=>{if(s==="entry_date"||s==="created_at")a+=`<td>${E(l[s])}</td>`;else if(t==="hrv"&&typeof l[s]=="number")a+=`<td>${Math.round(l[s])}</td>`;else if(t==="oirearviokyselyt"&&s==="stress_level"){let d=Object.keys(l).filter(i=>l[i]===1&&!["symptom_id","user_id","entry_date","stress_level"].includes(i)).map(i=>i.replace(/_/g," ")),h=d.length>0?d.join(", "):"Ei oireita";a+=`<td>${h}</td>`,a+=`<td>${l.stress_level}</td>`}else a+=`<td>${l[s]}</td>`}),a+="</tr>"}),a+="</tbody></table>",o.innerHTML+=a}
