import"./style-Bvx2onkj.js";import{f as u}from"./fetch-dnjvk_SN.js";import{s as m}from"./toast-B-6j1RQv.js";let i;document.addEventListener("DOMContentLoaded",function(){const t=document.querySelector(".menu-toggle"),e=document.querySelector(".menu");t.addEventListener("click",function(){e.classList.toggle("show")}),document.querySelector(".back").addEventListener("click",function(){document.getElementById("detailsModal").style.display="none",document.getElementById("dataSelectionModal").style.display="block"}),document.querySelector(".logout a").addEventListener("click",function(c){c.preventDefault(),console.log("Logout event triggered"),localStorage.removeItem("user_id"),localStorage.removeItem("token"),m("Kirjaudutaan ulos."),setTimeout(()=>{console.log("Redirecting to index.html"),window.location.href="index.html"},2e3)}),p(),f(),g(),v()});async function p(){const t="http://localhost:3000/api/student/",o={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};u(t,o).then(n=>{console.log(n),k(n)})}function k(t){const e=document.querySelector("#userTable tbody");e.innerHTML="",t.forEach(o=>{const n=document.createElement("tr");n.innerHTML=`<td>${o.user_id}</td><td>${o.username}</td><td>${o.title}</td>`,n.onclick=()=>y(o.user_id),e.appendChild(n)})}function y(t){i=t,document.getElementById("dataSelectionModal").style.display="block"}function f(){document.querySelector("#userTable tbody").addEventListener("click",e=>{let o=e.target;for(;o.tagName!=="TD";)o=o.parentNode;const n=o.parentNode.firstChild.textContent;y(n)})}function g(){document.querySelectorAll(".data-select").forEach(t=>{t.addEventListener("click",function(){_(t.dataset.type)})})}function v(){document.querySelectorAll(".modal").forEach(t=>{const e=t.querySelector(".close");e.onclick=function(){t.style.display="none"}}),window.onclick=function(t){document.querySelectorAll(".modal").forEach(e=>{t.target===e&&(e.style.display="none")})}}async function _(t){const e={hrv:`http://localhost:3000/api/hrv/${i}`,kokonaisanalyysit:`http://localhost:3000/api/analysis/user/${i}`,elämäntapakyselyt:`http://localhost:3000/api/lifestyle/${i}`,oirearviokyselyt:`http://localhost:3000/api/symptoms/${i}`};u(e[t],{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(o=>{console.log(o),S(o,t),document.getElementById("dataSelectionModal").style.display="none",document.getElementById("detailsModal").style.display="block"}).catch(o=>{console.error("Error fetching data:",o),m("Ei dataa saatavilla.")})}function E(t){const e={year:"numeric",month:"long",day:"numeric"};return new Date(t).toLocaleDateString("fi-FI",e)}function S(t,e){const o=document.getElementById("detailsContent");o.innerHTML=`<h3>${e.toUpperCase()} :</h3>`;let n={hrv:["Päivämäärä","Bpm Keskiarvo","Stressi-indeksi","Valmiustila (%)","SDNN (ms)","RMDDS (ms)"],kokonaisanalyysit:["Päivämäärä","Analyysi","Pisteet"],oirearviokyselyt:["Päivämäärä","Oireet","Stressitaso"],elämäntapakyselyt:["Päivämäärä","Unen määrä","Unen laatu","Tuntee olonsa terveeksi","Liikunta","Alkoholiannokset","Nikotiini(mg)","Kofeiini"]},c={hrv:["entry_date","av_hrv","stress_index","readiness","sdnn_ms","mean_rr_ms"],kokonaisanalyysit:["created_at","analysis_result","analysis_enumerated"],oirearviokyselyt:["entry_date","stress_level"],elämäntapakyselyt:["entry_date","hours_slept","quality_sleep","feel_healthy","physical_activity","alcohol_intake","nicotine_intake","caffeine_intake"]},a=`<table class='data-table'>
        <thead>
            <tr>`;n[e].forEach(l=>{a+=`<th>${l}</th>`}),a+=`</tr>
        </thead>
        <tbody>`,t.forEach(l=>{a+="<tr>",c[e].forEach(s=>{if(s==="entry_date"||s==="created_at")a+=`<td>${E(l[s])}</td>`;else if(e==="hrv"&&typeof l[s]=="number")a+=`<td>${Math.round(l[s])}</td>`;else if(e==="oirearviokyselyt"&&s==="stress_level"){let d=Object.keys(l).filter(r=>l[r]===1&&!["symptom_id","user_id","entry_date","stress_level"].includes(r)).map(r=>r.replace(/_/g," ")),h=d.length>0?d.join(", "):"Ei oireita";a+=`<td>${h}</td>`,a+=`<td>${l.stress_level}</td>`}else a+=`<td>${l[s]}</td>`}),a+="</tr>"}),a+="</tbody></table>",o.innerHTML+=a}
