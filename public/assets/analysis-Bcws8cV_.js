import"./style-Bvx2onkj.js";import{f as p}from"./fetch-dnjvk_SN.js";import{s as h}from"./toast-B-6j1RQv.js";document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".menu-toggle"),t=document.querySelector(".menu"),a=document.querySelector(".logout a");e.addEventListener("click",function(){t.classList.toggle("show")}),a.addEventListener("click",function(n){n.preventDefault(),localStorage.removeItem("analysisModalShown"),localStorage.removeItem("user_id"),localStorage.removeItem("token"),h("Kirjaudutaan ulos."),setTimeout(()=>{window.location.href="index.html"},2e3)}),y()});am5.ready(function(){const e=am5.Root.new("graph2");e.setThemes([am5themes_Animated.new(e)]);const t=e.container.children.push(am5xy.XYChart.new(e,{panX:!1,panY:!1,wheelX:"panX",wheelY:"zoomX",paddingLeft:20,paddingRight:40,paddingBottom:50,layout:e.verticalLayout}));t.children.unshift(am5.Label.new(e,{text:"Stressitasoanalyysi",fontSize:20,fontWeight:"400",fontFamily:"Poppins, sans-serif",textAlign:"center",x:am5.percent(50),centerX:am5.percent(50),paddingTop:0,paddingBottom:20}));const a=localStorage.getItem("user_id"),n=localStorage.getItem("token"),s=`http://localhost:3000/api/analysis/user/${a}`,i={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}};p(s,i).then(r=>{console.log(r);const o=r.map(d=>({date:new Date(d.created_at),value:d.analysis_enumerated})),c=am5xy.AxisRendererX.new(e,{minGridDistance:85,minorGridEnabled:!0}),m=t.xAxes.push(am5xy.CategoryAxis.new(e,{categoryField:"date",renderer:c}));c.grid.template.setAll({location:1}),c.labels.template.setAll({paddingTop:20}),m.data.setAll(o);const g=t.yAxes.push(am5xy.ValueAxis.new(e,{min:0,max:3,maxPrecision:0,renderer:am5xy.AxisRendererY.new(e,{strokeOpacity:.1})})),l=t.series.push(am5xy.ColumnSeries.new(e,{xAxis:m,yAxis:g,valueYField:"value",categoryXField:"date"}));l.columns.template.setAll({tooltipText:"{categoryX}: {valueY}",tooltipY:0,strokeOpacity:0,cornerRadiusTL:6,cornerRadiusTR:6}),l.columns.template.adapters.add("fill",function(d,u){return t.get("colors").getIndex(l.dataItems.indexOf(u.dataItem))}),l.data.setAll(o),l.appear(),t.appear(1e3,100),console.log(o)})});async function y(){const t=`http://localhost:3000/api/analysis/user/${localStorage.getItem("user_id")}`,n={method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}};p(t,n).then(s=>{x(s)})}function x(e){console.log(e);const t=document.querySelector(".tbody");t.innerHTML="",e.forEach(a=>{console.log(a.created_at,a.analysis_result,a.analysis_enumerated);const n=document.createElement("tr"),s=new Date(a.created_at).toLocaleDateString("fi-FI"),i=document.createElement("td");i.innerText=s;const r=document.createElement("td");r.innerText=a.analysis_result;const o=document.createElement("td");o.innerText=a.analysis_enumerated,n.appendChild(i),n.appendChild(r),n.appendChild(o),t.appendChild(n)})}
